<?xml version="1.0" encoding="UTF-8"?>
<model version="3.2.2">
 <framework name="qpc"/>
 <package name="calc" stereotype="0x00">
  <class name="Calc1" superclass="qpc::QHsm">
   <statechart>
    <initial target="../1">
     <action>BSP_message(&quot;on-INIT;&quot;);</action>
     <initial_glyph conn="3,16,5,3,3">
      <action box="0,-2,6,2"/>
     </initial_glyph>
    </initial>
    <state name="On">
     <entry>BSP_message(&quot;on-ENTRY;&quot;);</entry>
     <exit>BSP_message(&quot;on-EXIT;&quot;);</exit>
     <initial target="../9">
      <action>BSP_message(&quot;ready-INIT;&quot;);</action>
      <initial_glyph conn="12,16,5,3,6">
       <action box="0,-2,6,2"/>
      </initial_glyph>
     </initial>
     <tran trig="C" target="..">
      <action>BSP_clear();</action>
      <tran_glyph conn="106,24,1,1,8,-8,-8">
       <action box="0,-2,6,2"/>
      </tran_glyph>
     </tran>
     <tran trig="OFF" target="../../2">
      <tran_glyph conn="106,31,1,0,8,17">
       <action box="0,-2,6,2"/>
      </tran_glyph>
     </tran>
     <state name="OpEntered">
      <entry>BSP_message(&quot;opEntered-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;opEntered-EXIT;&quot;);</exit>
      <tran trig="OPER">
       <choice target="../../../7">
        <guard brief="-">(((CalcEvt const *)e) -&gt;key_code == KEY_MINUS)</guard>
        <action>BSP_clear();</action>
        <choice_glyph conn="16,68,4,0,19">
         <action box="-3,1,6,2"/>
        </choice_glyph>
       </choice>
       <tran_glyph conn="16,62,2,-1,6">
        <action box="-4,1,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_0" target="../../6/3">
       <action>BSP_clear();</action>
       <tran_glyph conn="18,62,2,0,16,37,9">
        <action box="0,14,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_1_9" target="../../6/4">
       <action>BSP_clear();
BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="20,62,2,0,14,44,11">
        <action box="0,12,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="POINT" target="../../6/5">
       <action>BSP_clear();
BSP_insert((int)'0');
BSP_insert((int)'.');</action>
       <tran_glyph conn="22,62,2,0,12,57,13">
        <action box="0,10,6,2"/>
       </tran_glyph>
      </tran>
      <state_glyph node="14,48,12,14">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Negated1">
      <entry>BSP_message(&quot;negated1-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;negated1-EXIT;&quot;);</exit>
      <tran trig="OPER">
       <choice>
        <guard brief="-">(((CalcEvt const *)e) -&gt;key_code == KEY_MINUS)</guard>
        <choice_glyph conn="38,57,5,-1,-4">
         <action box="-3,-2,6,2"/>
        </choice_glyph>
       </choice>
       <tran_glyph conn="44,57,1,-1,-6">
        <action box="-4,-2,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="CE" target="../../9/5">
       <action>BSP_clear();</action>
       <tran_glyph conn="34,62,2,3,4,-4,-42,2">
        <action box="-4,2,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_0" target="../../8/5">
       <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="40,62,2,2,2,15,-2">
        <action box="0,0,7,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_1_9" target="../../8/3">
       <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="38,62,2,2,4,29,-4">
        <action box="0,2,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="POINT" target="../../8/4">
       <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="36,62,2,2,6,41,-6">
        <action box="0,4,6,2"/>
       </tran_glyph>
      </tran>
      <state_glyph node="32,48,12,14">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Result">
      <entry>BSP_message(&quot;result-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;result-EXIT;&quot;);</exit>
      <state_glyph node="95,79,9,11">
       <entry box="1,2,6,2"/>
       <exit box="1,4,6,2"/>
      </state_glyph>
     </state>
     <state name="Operand2">
      <entry>BSP_message(&quot;operand2-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;operand2-EXIT;&quot;);</exit>
      <tran trig="CE" target="../../9/5">
       <action>BSP_clear();</action>
       <tran_glyph conn="82,110,2,1,2,7,-90,-15">
        <action box="2,0,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="OPER">
       <choice target="../../../3">
        <guard brief="isValid">BSP_eval(me-&gt;operand1, me-&gt;operator, BSP_get_value())</guard>
        <action>me-&gt;operand1 = BSP_get_value();
me-&gt;operator = ((CalcEvt const *)e)-&gt;key_code;</action>
        <choice_glyph conn="56,116,5,0,-48,-73,11,5">
         <action box="-7,-2,10,2"/>
        </choice_glyph>
       </choice>
       <choice target="../../../10">
        <guard>else</guard>
        <choice_glyph conn="56,116,5,0,37,-20,5,3">
         <action box="2,-2,10,2"/>
        </choice_glyph>
       </choice>
       <tran_glyph conn="56,110,2,-1,6">
        <action box="0,0,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="EQUALS">
       <choice target="../../../5">
        <guard brief="isValid">BSP_eval(me-&gt;operand1, me-&gt;operator, BSP_get_value())</guard>
        <choice_glyph conn="91,94,4,0,-20,7,5">
         <action box="0,-3,10,2"/>
        </choice_glyph>
       </choice>
       <choice target="../../../10">
        <guard>else</guard>
        <choice_glyph conn="91,94,5,0,10,5">
         <action box="3,0,10,2"/>
        </choice_glyph>
       </choice>
       <tran_glyph conn="70,110,2,-1,4,21,-20">
        <action box="-6,0,6,2"/>
       </tran_glyph>
      </tran>
      <state name="Zero2">
       <entry>BSP_message(&quot;zero2-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;zero1-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <tran_glyph conn="51,96,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9" target="../../4">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="57,101,2,2,3,8,-3">
         <action box="0,1,9,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT" target="../../5">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="58,87,0,0,-4,19,4">
         <action box="0,-4,5,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="51,87,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state name="Int2">
       <entry>BSP_message(&quot;int2-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;int2-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="62,96,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="62,99,3,-1,7">
         <action box="0,-2,8,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT" target="../../5">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="68,87,0,0,-2,7,2">
         <action box="1,-2,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="62,87,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state name="Frac2">
       <entry>BSP_message(&quot;frac2-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;frac2-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="73,95,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="73,97,3,-1,7">
         <action box="0,-2,8,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT">
        <tran_glyph conn="73,99,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="73,87,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state_glyph node="49,79,35,31">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Negated2">
      <entry>BSP_message(&quot;negated2-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;negated2-EXIT;&quot;);</exit>
      <tran trig="OPER">
       <choice>
        <guard brief="-">(((CalcEvt const *)e) -&gt;key_code == KEY_MINUS)</guard>
        <choice_glyph conn="20,97,5,-1,-4">
         <action box="-3,-2,6,2"/>
        </choice_glyph>
       </choice>
       <tran_glyph conn="26,97,1,-1,-6">
        <action box="-4,-2,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="CE" target="../../3">
       <action>BSP_clear();</action>
       <tran_glyph conn="16,101,2,0,3,-6,-59,7,3">
        <action box="-6,1,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_0" target="../../6/3">
       <tran_glyph conn="22,101,2,2,3,33,-3">
        <action box="0,1,7,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_1_9" target="../../6/4">
       <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="20,101,2,2,5,48,-5">
        <action box="0,3,9,2"/>
       </tran_glyph>
      </tran>
      <tran trig="POINT" target="../../6/5">
       <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="18,101,2,2,7,59,-7">
        <action box="0,5,6,2"/>
       </tran_glyph>
      </tran>
      <state_glyph node="14,87,12,14">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Operand1">
      <entry>BSP_message(&quot;operand1-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;operand1-EXIT;&quot;);</exit>
      <tran trig="CE" target="../../9/5">
       <action>BSP_clear();</action>
       <tran_glyph conn="84,51,1,1,3,-27,-13">
        <action box="0,-2,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="OPER" target="../../3">
       <action>me-&gt;operand1 = BSP_get_value();
me-&gt;operator = ((CalcEvt const *)e)-&gt;key_code;</action>
       <tran_glyph conn="64,70,2,0,2,-36,-29,-5,5">
        <action box="-36,0,6,2"/>
       </tran_glyph>
      </tran>
      <tran trig="EQUALS" target="../../5">
       <tran_glyph conn="69,70,2,0,2,32,7">
        <action box="0,0,6,2"/>
       </tran_glyph>
      </tran>
      <state name="Int1">
       <entry>BSP_message(&quot;int1-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;int1-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="62,57,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="62,60,3,-1,7">
         <action box="0,-2,8,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT" target="../../4">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="68,48,0,0,-2,7,2">
         <action box="1,-2,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="62,48,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state name="Frac1">
       <entry>BSP_message(&quot;frac1-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;frac1-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="73,56,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="73,58,3,-1,7">
         <action box="0,-2,8,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT">
        <tran_glyph conn="73,60,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="73,48,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state name="Zero1">
       <entry>BSP_message(&quot;zero1-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;zero1-EXIT;&quot;);</exit>
       <tran trig="DIGIT_0">
        <tran_glyph conn="51,57,3,-1,7">
         <action box="0,-2,6,2"/>
        </tran_glyph>
       </tran>
       <tran trig="DIGIT_1_9" target="../../3">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="57,62,2,2,2,8,-2">
         <action box="0,0,9,2"/>
        </tran_glyph>
       </tran>
       <tran trig="POINT" target="../../4">
        <action>BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
        <tran_glyph conn="58,48,0,0,-4,19,4">
         <action box="0,-4,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="51,48,9,14">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state_glyph node="49,40,35,30">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Ready">
      <entry>BSP_message(&quot;ready-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;ready-EXIT;&quot;);</exit>
      <initial target="../5">
       <action>BSP_message(&quot;ready-INIT;&quot;);</action>
       <initial_glyph conn="22,22,5,3,10">
        <action box="0,-2,6,2"/>
       </initial_glyph>
      </initial>
      <tran trig="DIGIT_0" target="../../8/5">
       <action>BSP_clear();</action>
       <tran_glyph conn="55,31,2,0,17">
        <action box="0,1,11,2"/>
       </tran_glyph>
      </tran>
      <tran trig="DIGIT_1_9" target="../../8/3">
       <action>BSP_clear();
BSP_insert(((CalcEvt const *)e)-&gt;key_code);</action>
       <tran_glyph conn="64,31,2,0,17">
        <action box="0,1,11,2"/>
       </tran_glyph>
      </tran>
      <tran trig="POINT" target="../../8/4">
       <action>BSP_clear();
BSP_insert((int)'0');
BSP_insert((int)'.');</action>
       <tran_glyph conn="79,31,2,0,17">
        <action box="0,1,8,2"/>
       </tran_glyph>
      </tran>
      <tran trig="OPER" target="../../3">
       <action>me-&gt;operand1 = BSP_get_value();
me-&gt;operator = ((CalcEvt const *)e)-&gt;key_code;</action>
       <tran_glyph conn="21,31,2,0,17">
        <action box="0,1,9,2"/>
       </tran_glyph>
      </tran>
      <state name="Begin">
       <entry>BSP_message(&quot;begin-ENTRY;&quot;);</entry>
       <exit>BSP_message(&quot;begin-EXIT;&quot;);</exit>
       <tran trig="OPER">
        <choice target="../../../../4">
         <guard brief="-">(((CalcEvt const *)e) -&gt;key_code == KEY_MINUS)</guard>
         <choice_glyph conn="37,36,4,0,12">
          <action box="0,1,6,3"/>
         </choice_glyph>
        </choice>
        <tran_glyph conn="37,27,2,-1,9">
         <action box="0,5,6,2"/>
        </tran_glyph>
       </tran>
       <state_glyph node="32,19,42,8">
        <entry box="1,2,5,2"/>
        <exit box="1,4,5,2"/>
       </state_glyph>
      </state>
      <state_glyph node="18,13,66,18">
       <entry box="1,2,5,2"/>
       <exit box="1,4,5,2"/>
      </state_glyph>
     </state>
     <state name="Error">
      <entry>BSP_message(&quot;error-ENTRY;&quot;);</entry>
      <exit>BSP_message(&quot;error-EXIT;&quot;);</exit>
      <state_glyph node="95,99,9,11">
       <entry box="1,2,6,2"/>
       <exit box="1,4,6,2"/>
      </state_glyph>
     </state>
     <state_glyph node="6,6,100,114">
      <entry box="1,2,5,2"/>
      <exit box="1,4,5,2"/>
     </state_glyph>
    </state>
    <state name="Final">
     <entry>BSP_message(&quot;final-ENTRY;&quot;);
BSP_exit();</entry>
     <state_glyph node="108,48,12,14">
      <entry box="1,2,5,2"/>
     </state_glyph>
    </state>
    <state_diagram size="130,124"/>
   </statechart>
  </class>
 </package>
</model>
